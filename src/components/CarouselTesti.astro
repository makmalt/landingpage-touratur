---
const { content } = Astro.props;
---

<div class="w-full flex justify-center">
  <div
    class="carousel w-full md:w-2/3 relative overflow-hidden"
    id="custom-carousel"
  >
    <!-- Track / Slide Wrapper -->
    <div
      class="carousel-track flex transition-transform duration-700"
      style="width: 600%;"
    >
      <!-- Slide 1 -->
      <div class="carousel-item w-full flex justify-center shrink-0">
        <div class="w-3/5 h-100 md:h-64 flex items-center">
          <img
            src="/foto-testi/Prof Endang.webp"
            alt="foto prof endang"
            class="w-40 h-40 object-cover rounded-full mr-4"
          />
          <p class="text-left text-xl font-serif opacity-75">
            “{content.isi1}”<br /><br />
            <span class="text-lg">
              <b>Prof Endang (Guru Besar Unpad & Dokter di RSHS)</b> | Vietnam Trip
            </span>
          </p>
        </div>
      </div>

      <!-- Slide 2 -->
      <div class="carousel-item w-full flex justify-center shrink-0">
        <div class="w-3/5 h-100 md:h-64 flex items-center">
          <img
            src="/foto-testi/Ibu Lia.webp"
            alt="foto ibu lia"
            class="w-40 h-40 object-cover rounded-full mr-4"
          />
          <p class="text-left text-xl font-serif opacity-75">
            “{content.isi2}”<br /><br />
            <span class="text-lg">
              <b>Ibu Lia (Ketua IIDI Bandung)</b> | Vietnam Trip
            </span>
          </p>
        </div>
      </div>

      <!-- Slide 3 -->
      <div class="carousel-item w-full flex justify-center shrink-0">
        <div class="w-3/5 h-100 md:h-64 flex items-center">
          <img
            src="/foto-testi/Asep Goparuloh.webp"
            alt="foto asep goparuloh"
            class="w-40 h-40 object-cover rounded-full mr-4"
          />
          <p class="text-left text-xl font-serif opacity-75">
            “{content.isi3}”<br /><br />
            <span class="text-lg">
              <b>Asep Goparuloh (Sekretaris Daerah Kota Tasikmalaya)</b> | Belitung
              Trip
            </span>
          </p>
        </div>
      </div>

      <!-- Slide 4 -->
      <div class="carousel-item w-full flex justify-center shrink-0">
        <div class="w-3/5 h-100 md:h-64 flex items-center">
          <img
            src="/foto-testi/Prof Ilya Avianti.webp"
            alt="foto prof ilya"
            class="w-40 h-40 object-cover rounded-full mr-4"
          />
          <p class="text-left text-xl font-serif opacity-75">
            “{content.isi4}”<br /><br />
            <span class="text-lg">
              <b>Prof Ilya Avianti (Guru Besar Unpad)</b> | Belitung Trip
            </span>
          </p>
        </div>
      </div>

      <!-- Slide 5 -->
      <div class="carousel-item w-full flex justify-center shrink-0">
        <div class="w-3/5 h-100 md:h-64 flex items-center">
          <img
            src="/foto-testi/dr. Dzulfikar.webp"
            alt="foto dr dzulfikar"
            class="w-40 h-40 object-cover rounded-full mr-4"
          />
          <p class="text-left text-xl font-serif opacity-75">
            “{content.isi5}”<br /><br />
            <span class="text-lg">
              <b>Dr Dzulfikar Sp.A (Ketua IDAI Jabar)</b> | Pangandaran Trip
            </span>
          </p>
        </div>
      </div>

      <!-- Clone Slide 1 for smooth looping -->
      <div class="carousel-item w-full flex justify-center shrink-0">
        <div class="w-3/5 h-100 md:h-64 flex items-center">
          <img
            src="/foto-testi/Prof Endang.webp"
            alt="foto prof endang"
            class="w-40 h-40 object-cover rounded-full mr-4"
          />
          <p class="text-left text-xl font-serif opacity-75">
            “{content.isi1}”<br /><br />
            <span class="text-lg">
              <b>Prof Endang (Guru Besar Unpad & Dokter di RSHS)</b> | Vietnam Trip
            </span>
          </p>
        </div>
      </div>
    </div>

    <!-- Controls -->
    <div
      class="absolute left-5 right-5 top-1/2 flex -translate-y-1/2 transform justify-between z-10"
    >
      <button id="prevSlide" class="btn btn-circle bg-white text-black shadow"
        >❮</button
      >
      <button id="nextSlide" class="btn btn-circle bg-white text-black shadow"
        >❯</button
      >
    </div>
  </div>
</div>

<!-- JS -->
<script is:inline>
  let currentSlide = 0;
  const track = document.querySelector("#custom-carousel .carousel-track");
  const slides = track.children;
  const totalSlides = 5; // asli, exclude clone

  function updateSlide(animate = true) {
    if (!animate) {
      track.classList.remove("transition-transform", "duration-700");
    } else {
      track.classList.add("transition-transform", "duration-700");
    }
    track.style.transform = `translateX(-${currentSlide * 100}%)`;
  }

  function handleNext() {
    currentSlide++;
    updateSlide();

    if (currentSlide === totalSlides) {
      setTimeout(() => {
        currentSlide = 0;
        updateSlide(false);
      }, 700);
    }
  }

  function handlePrev() {
    if (currentSlide === 0) return;
    currentSlide--;
    updateSlide();
  }

  document.getElementById("nextSlide").addEventListener("click", () => {
    handleNext();
    resetAutoSlide();
  });

  document.getElementById("prevSlide").addEventListener("click", () => {
    handlePrev();
    resetAutoSlide();
  });

  let slideInterval = setInterval(() => {
    handleNext();
  }, 5000);

  function resetAutoSlide() {
    clearInterval(slideInterval);
    slideInterval = setInterval(() => {
      handleNext();
    }, 5000);
  }

  updateSlide();
</script>
